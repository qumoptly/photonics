<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Software from RP Photonics - Propagating Optical Fields in Fibers Based on Modes or with Numerical Beam Propagation</title>
<link rel="stylesheet" type="text/css" href="./styles.css">
<link rel="shortcut icon" href="./img/favicon.png" type="image/png">
<link rel="canonical" href="https://www.rp-photonics.com/software_news_2018_09_12.html">
<link rel="alternate" type="application/rss+xml" title="The Photonics Spotlight" href="https://www.rp-photonics.com/spotlight.rss">
<link rel="alternate" type="application/rss+xml" title="The RP Photonics Software News" href="https://www.rp-photonics.com/software_news.rss">
<link rel="alternate" type="application/rss+xml" title="New encyclopedia articles" href="https://www.rp-photonics.com/new_articles.rss">
<meta name="date" content="2018-09-12">
<meta name="description" content="Mode-based techniques and numerical beam propagation are very different technical methods for propagating optical fields. This article explains them and discusses their limitations in various cases.">
<meta name="copyright" content="2020 RP Photonics Consulting GmbH">
<meta name="author" content="Dr. R&uuml;diger Paschotta">
<meta name="publisher" content="RP Photonics Consulting GmbH">
<meta name="keywords" content="photonics, modeling, software, optics, lasers, simulations, analysis, optimization, news, newsletter">
<meta property="og:type" content="article">
<meta property="og:title" content="Software from RP Photonics - Propagating Optical Fields in Fibers Based on Modes or with Numerical Beam Propagation">
<meta property="og:description" content="Mode-based techniques and numerical beam propagation are very different technical methods for propagating optical fields. This article explains them and discusses their limitations in various cases.">
<meta property="og:url" content="https://www.rp-photonics.com/software_news_2018_09_12.html">
<meta property="og:image" content="https://www.rp-photonics.com/previews/software_news_2018_09_12.png">
<meta property="og:image:type" content="image/png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Mode-based techniques and numerical beam propagation are very different technical methods for propagating optical fields. This article explains them and discusses their limitations in various cases.">
<meta name="twitter:title" content="Software from RP Photonics - Propagating Optical Fields in Fibers Based on Modes or with Numerical Beam Propagation">
<meta name="twitter:image" content="https://www.rp-photonics.com/previews/software_news_2018_09_12.png">
<script type="text/javascript" src="./jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="./general.js"></script>
<script type="text/javascript" nonce="K1lPwiVoW2YI4NwyLWmQVQ==">
page="software_news_2018_09_12.html"; cat="S"; shownbanner=""; ref="http://www.rp-photonics.com/spotlight_2020_04_01.html"; shownsponsors = "";
ts = new Date().toJSON().substring(0, 19);
$(document).ready(function($){ $.get("./log.php",{cat:cat,page:page,ref:ref,shownbanner:shownbanner,shownsponsors:shownsponsors,ts:ts}); })
</script>
</head>
<body>
<div id="logohead">
<div class="areadiv"><table id="areatable"><tr><td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="./marketing.html">RP Photonics Marketing</a></td></tr>
<tr><td><a href="./encyclopedia.html">Encyclopedia</a></td>
<td><a href="./buyersguide.html">Buyer's Guide</a></td></tr>
</table></div>
</td>
<td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="./consulting.html">RP Services and Tools</a></td></tr>
<tr><td><a href="./consulting.html">Consulting</a></td>
<td class="selected"><a href="./software.html">Software</a></td></tr>
</table></div>
</td></tr></table></div>
<img src="img/rp_photonics.png" alt="RP Photonics logo" id="rplogo">
<p><span id="title2">Software</span> <span id="slogan">&hellip; powerful tools for your research &amp; development!</span></p>
</div>
<nav id="soft">
<div id="navitems">
<a id="Software_start" href="software.html">Introduction</a>
<a id="Modeling" href="software_modeling.html">Modeling</a>
<a id="software_news" href="software_news.html" class="sel">Software News</a>
<p>Products:</p>
<a id="Overview" href="software_overview.html">Overview</a>
<a id="rp_fiber_calculator" href="rp_fiber_calculator.html">RP Fiber Calculator</a>
<a id="rp_fiberpower" href="fiberpower.html">RP Fiber Power</a>
<a id="rp_resonator" href="resonator.html">RP Resonator</a>
<a id="rp_propulse" href="propulse.html">RP ProPulse</a>
<a id="rp_coating" href="coating.html">RP Coating</a>
<a id="rp_q_switch" href="rp_q_switch.html">RP Q-switch</a>
<p>Various aspects:</p>
<a id="script_language" href="software_script_language.html">Script language</a>
<a id="debugger" href="software_debugger.html">Debugger</a>
<a id="custom_forms" href="software_custom_forms.html">Custom forms</a>
<a id="licenses" href="software_licenses.html">Licenses</a>
<a id="documentation" href="software_docu.html">Documentation</a>
<a id="support" href="software_support.html">Support</a>
<a id="distributors" href="software_distributors.html">Distributors</a>
<p>Take action:</p>
<a id="contact" href="software_contact.html">*Get a quotation*</a>
</div>
</nav>
<div id="main" style="margin-top:20px;">
<main>
<p class="breadcrumbs"><a href="software.html">RP Photonics Software News</a> &gt; <a href="software_news_2018_09_12.html">2018-09-12</a></p>
<h1 class="posting">Propagating Optical Fields in Fibers Based on Modes or with Numerical Beam Propagation</h1>
<div class="posting_details">
<p>Posted on 2018-09-12 in the <a href="software_news.html">RP Photonics Software News (available as e-mail newsletter!)</a>
<p>Permanent link: <a href="software_news_2018_09_12.html" class="url">https://www.rp-photonics.com/software_news_2018_09_12.html</a></p>
<p>Author: <a href="https://www.rp-photonics.com/paschotta.html" rel="author">Dr. Rüdiger Paschotta</a>, <a href="https://www.rp-photonics.com/">RP Photonics Consulting GmbH</a></p>
<p>Abstract: Mode-based techniques and numerical beam propagation are very different technical methods for propagating optical fields. This article explains them and discusses their limitations in various cases.</p>
</div>
<figure class="right" style="width:130px;">
<img src="img/paschotta5.jpg" alt="Dr. Rüdiger Paschotta">
</figure>
<p>In many cases, one needs to calculate how some optical field with a certain transverse profile propagates through a medium, e.g. an optical <a href="fibers.html" title="a kind of long and thin optical waveguides which can be bent to some degree">fiber</a>.</p>
<p>Clearly, simple <a href="software_news_2015_03_23.html">power propagation</a> cannot be used, if we need the full transverse profiles.
There are fundamentally different numerical approaches which can be used:</p>
<h2 class="togglediv">Mode-based Approach</h2>
<div>
<p>Here, we first calculate the <a href="modes.html" title="self-consistent electric field distributions in waveguides, optical resonators or in free space">modes</a> of the fiber &ndash; usually, only considering guided modes.
For each of those modes, we can calculate a complex amplitude simply with an overlap integral which contains both the initial field and the mode amplitude function.
Thereafter, we multiply each mode amplitude with a phase factor; the phase delay is simply the phase constant (<span class="eqn_il"><span class="greek">&beta;</span></span> value) of that mode (which a mode solver like that in <a href="fiberpower.html">RP Fiber Power</a> will tell us) times the propagation distance.
We can then assemble the total field as a superposition of the mode functions, using the modified mode amplitudes.</p>
<p>Mode -dependent propagation losses can of course also be easily be taken into account &ndash; simply in the form of complex <a href="propagation_constant.html" title="a mode- and frequency-dependent quantity describing the propagation of light in a medium or waveguide">propagation constants</a>.</p>
</div>
<h2 class="togglediv">Numerical Beam Propagation</h2>
<div>
<p>A completely different approach is numerical beam propagation.
Here, we use a numerical algorithm which can calculate the field after some small propagation distance with a reasonable accuracy.
By performing many such steps subsequently, one can obtain propagation over larger distances.</p>
<p>There are different algorithms for beam propagation.
Some are based on finite-element methods or similar, while others are based on Fourier transforms (split-step Fourier method).
Technically, this is a difficult topic, but some software (e.g. <a href="fiberpower.html">RP Fiber Power</a>) provides such features which are then reasonably simple to use.
One challenge can be to determent reasonable parameters for the numerical grid; I have covered that in the <a href="software_news_2018_08_02.html">RP Photonics Software News of 2018-08-02</a>.</p>
</div>
<h2 class="togglediv">A Comparison</h2>
<div>
<p>In the following, I discuss various aspects which in a concrete case can favor one method or exclude another one.</p>
<h3 class="togglediv">Large Propagation Distances</h3>
<div>
<p>Obviously, the computational effort of the mode-based approach does not depend on the propagation distance.
It is only that for long distances small errors in the phase constants of the modes become more critical.
This is not just a numerical issue: any real fiber will exhibit some fluctuations of its parameters and therefore of its phase constants.
Therefore, the precise outcome cannot be predicted any more for a large propagation distance.</p>
<p>For numerical beam propagation, propagation distances of many meters in a fiber can become problematic, since a large number of numerical steps is required.
Particularly for small-core fibers with high <a href="numerical_aperture.html" title="sine of the maximum angle of an incident beam of some optical device, or the sine of the acceptance angle of a waveguide or fiber">numerical aperture</a>, the numerical step size needs to be rather small (often only a few micrometers), and millions of steps as required for several meters may challenge your patience.
There can be also a problem with computer memory, if you need to store the amplitude profiles for all intermediate steps.
Frequently, however, at least the latter problem can be easily solved by storing the fields only on a relatively coarse <a href="software_news_2018_08_02.html">numerical grid</a>.</p>
</div>
<h3 class="togglediv">Cladding Modes</h3>
<div>
<p>In many cases, we can safely ignore <a href="cladding_modes.html" title="modes in optical fibers (or other waveguides) which are not restricted to the region around the core">cladding modes</a> of the fiber, assuming that their losses over the relevant propagation distance are very high.
For the mode-based approach this is very nice, since we have to deal with a usually quite limited number of modes.
Four numerical beam propagation, it means that we have to consider only a relatively small volume, not extending that much beyond the <a href="fiber_core.html" title="the region in an optical fiber which guides light">fiber core</a>.
One should then simply include some artificial loss in the cladding area in order to get light removed from there.
Otherwise, it would be reflected at the outer boundaries of the numerical grid and would thus produce artifacts.</p>
<p>Sometimes, however, cladding modes are relevant.
For the mode-based approach, this can be a serious problem: we have to calculate all the cladding modes as well, and that can dramatically increase the number of modes, possibly even making the whole approach no longer feasible.</p>
<p>For numerical beam propagation, we simply have to extend the numerical grid such that it covers the full cladding area and also extends somewhat into the coating (or air).
The price to pay is simply that we are dealing with a larger grid, requiring more memory and computation time.</p>
</div>
<h3 class="togglediv">Bending of the Fiber</h3>
<div>
<p>If a fiber is bent, that breaks its radial symmetry.
As a result, simple LP mode solvers can no longer be used.
There are more sophisticated numerical mode solvers, which not every software offers, and which are computationally more demanding.</p>
<p>For numerical beam propagation, bending is relatively simple to include.
Its effect can be simulated as a modification of the <a href="refractive_index.html" title="a measure of the reduction in the velocity of light in a medium">refractive index</a> profile with an addition which is proportional e.g. to the <span class="eqn_il"><i>x</i></span> coordinate.
A proper choice of the proportionality constant can be used to take into account the effect of mechanical stress as well.</p>
<figure>
<img src="img/fiberpower_bend_loss1.png" alt="bend losses in a large mode area fiber">
<figcaption><span class="start">Figure&nbsp;1:</span> 
Amplitude distribution in a large mode area fiber, which is bent more and more strongly towards the right side.
The fiber mode becomes substantially smaller and then very lossy; the light is coupled out into cladding modes.
The <a href="fiberpower_bend_loss.html">numerical simulation</a> has been done with the <a href="fiberpower.html"><b>RP Fiber Power</b></a> software.
</figcaption>
</figure>
</div>
<h3 class="togglediv">Inhomogeneous Fibers</h3>
<div>
<p>Some fibers have properties which change along the length.
For example, there are <a href="tapered_fibers.html" title="optical fibers which are over some length stretched out to a very small diameter">tapered fibers</a>, where the core diameter varies gradually.
Other fibers contain things like <a href="fiber_bragg_gratings.html" title="reflective structures in the core of an optical fiber with a periodic or aperiodic perturbation of the effective refractive index">fiber Bragg gratings</a>, e.g. long-period gratings which do not cause reflections but <a href="mode_coupling.html" title="a concept for describing and calculating light propagation in certain situations, e.g. involving nonlinear interactions">mode coupling</a> &ndash; for example, coupling light from a guided mode into cladding modes.</p>
<p>The mode-based approach is usually not usable in such cases; it is not even obvious how to sensibly define <a href="modes.html" title="self-consistent electric field distributions in waveguides, optical resonators or in free space">modes</a> of such structures.
Well, there are specialized software products with sophisticated algorithms which are still usable at least for some of those problems.
Personally, I do not have experience with that.</p>
<p>Numerical beam propagation is most flexible.
Here, it is no problem to make the refractive index not only dependent on a radial coordinate <span class="eqn_il"><i>r</i></span>, or more generally on <span class="eqn_il"><i>x</i></span> and <span class="eqn_il"><i>y</i></span>, but also on the longitudinal coordinate <span class="eqn_il"><i>z</i></span>.
Therefore, it is easy to investigate light propagation in tapered fibers, for example, or even fibers with random fluctuations of the core diameter.
It is also not a problem to include a <a href="fiber_bragg_gratings.html" title="reflective structures in the core of an optical fiber with a periodic or aperiodic perturbation of the effective refractive index">fiber Bragg grating</a>.</p>
</div>
<h3 class="togglediv">Nonlinear Effects</h3>
<div>
<p>Particularly in the context of optical <a href="pulses.html" title="flashes of light">pulses</a>, which can have substantial <a href="peak_power.html" title="maximum optical power of a pulse">peak powers</a>, fibers <a href="nonlinearities.html" title="optical phenomena involving a nonlinear response to a driving light field">nonlinearities</a> can become quite relevant.
One might think that a mode-based approach is that no longer usable, but often it still is.
For example, one can iteratively calculate the modified modes of a fiber at a high optical power level; I have done this in a <a href="fiberpower_self_focusing.html">demo file</a> for our software.</p>
<p>On the other hand, numerical beam propagation methods are again quite flexible.
It is not too difficult to integrate optical nonlinearities.
I have done that not only for the Kerr nonlinearity, leading to <a href="self_phase_modulation.html" title="nonlinear phase modulation of a beam, caused by its own intensity via the Kerr effect">self-phase modulation</a> and <a href="cross_phase_modulation.html" title="a nonlinear effect where the optical intensity of one beam influences the phase change of another beam">cross-phase modulation</a>, but even for stimulated <a href="raman_scattering.html" title="a nonlinear scattering process involving optical phonons">Raman scattering</a>.</p>
<figure>
<img src="img/fiberpower_self_focusing1.png" alt="mode profile with strong self-focusing">
<figcaption><span class="start">Figure&nbsp;2:</span> 
Calculated normalized mode intensity profiles with and without nonlinear self-focusing.
The refractive index profiles are also shown (dashed without the nonlinearity).
One sees that the index profile is substantially modified by the nonlinear effect.
</figcaption>
</figure>
</div>
<h3 class="togglediv">Time-dependent Fields</h3>
<div>
<p>Sometimes it is necessary to include the time dependence of optical fields.
For the mode-based approach, this simply means that the mode amplitudes become time-dependent.</p>
<p>For numerical beam propagation, it is also possible to introduce time dependencies, but note that the computational effort and memory requirements may easily explode: everything is multiplied with the number of temporal steps.
Therefore, this is often not practical, or at least rather time-consuming and memory-intensive.</p>
<p>Anyway, not all is lost when time dependencies become important.
There are cases where one investigates the nonlinear propagation of a nanosecond optical pulse, for example, by doing the propagation for several power levels corresponding to different temporal locations in the pulse, and then combining the obtained results.
If the pulse duration is much longer than the group delay difference within the pulse spectrum, that can be a quite practical and efficient method.</p>
</div>
</div>
<h2 class="togglediv">Conclusions</h2>
<div>
<p>You see that different numerical methods have crucial advantages and limitations.
Depending on what exactly you need to simulate, some method may be superior, or even the only usable one.
Obviously, one should not start simulations before knowing what exactly should be investigated, and which assumptions are allowed.</p>
<p>Our software <a href="fiberpower.html"><b>RP Fiber Power</b></a> supports both methods.
Frequently, we even use both of them in a single simulation.
For example, there are cases where we use calculated mode fields as inputs to numerical beam propagation.
Also, we can calculate the mode amplitudes and powers along the fiber through overlap integrals involving the numerically calculated profiles and the mode profiles.</p>
<p>By the way, for the implementation of many tricks, some of which I mentioned above, it is essential that the used software is highly flexible.
I think the only practical way to obtain this is using a powerful <a href="software_script_language.html">script language</a> as supported by our software.
The above mentioned <a href="fiberpower_self_focusing.html">demo file with self-focusing</a> is a good example.
With a couple of lines of script code, you can implement sophisticated strategies (or get that code from me within the <a href="software_support.html">technical support</a>); otherwise, you would depend on very specialized features in the software, which are usually not available.</p>
</div>
<hr>
<p style="font-size:85%; margin-bottom:10px;">This article is a posting of the <a href="software_news.html">RP Photonics Software News</a>, authored by <a href="paschotta.html">Dr. Rüdiger Paschotta</a>.
You may link to this page, because its location is permanent.</p>
<p style="font-size:85%; margin-bottom:15px;">Note that you can also receive the articles in the form of a <a href="newsletters.html">newsletter</a> or with an <a href="https://www.rp-photonics.com/software_news.rss">RSS feed</a>.</p>

<table style="border-spacing:0"><tr>
<td style="width:60%; vertical-align:middle;">
<img src="previews/software_news_2018_09_12.png" alt="preview" class="article_preview"></td>
<td style="vertical-align:middle;">
<div id="socialbox_article">
<p style="font-size:90%">If you like this article, share it with your friends and colleagues, e.g. via social media:</p>
<a href="https://twitter.com/intent/tweet?lang=en&url=https%3A%2F%2Fwww.rp-photonics.com%2Fsoftware_news_2018_09_12.html&text=Software+from+RP+Photonics+-+Propagating+Optical+Fields+in+Fibers+Based+on+Modes+or+with+Numerical+Beam+Propagation" class="socialbutton twitter"><img src="./img/twitter.png" alt="Twitter"></a>
<a href="https://www.facebook.com/sharer/sharer.php?display=popup&u=https%3A%2F%2Fwww.rp-photonics.com%2Fsoftware_news_2018_09_12.html" class="socialbutton facebook"><img src="./img/facebook.png" alt="Facebook"></a>
<a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.rp-photonics.com%2Fsoftware_news_2018_09_12.html" class="socialbutton linkedin"><img src="./img/linkedin.png" alt="LinkedIn"></a>
<p style="font-size:85%">These sharing buttons are implemented in a <a href="./social_media.html">privacy-friendly</a> way!</p></div>
</td>
</tr></table>

<footer id="copyrightbox">
<span class="copyright">&copy; <a href="paschotta.html">Dr. Rüdiger Paschotta</a>, RP Photonics Consulting GmbH, also at <a href="https://profiles.google.com/109063044353551581702?rel=author">Google+</a>&nbsp;&nbsp;&nbsp;&nbsp; All rights reserved worldwide</span>
</footer>
</main></div>
<!--googleon: index-->
<script type="application/ld+json" nonce="K1lPwiVoW2YI4NwyLWmQVQ==">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "publisher": {
    "@type": "Organization",
    "name": "RP Photonics",
    "url": "https://www.rp-photonics.com/",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.rp-photonics.com/img/rp_photonics.png"
      }
  },
  "mainEntity": {
    "@type": "Article",
    "mainEntityOfPage": {
       "@type": "WebPage",
       "@id": "https://www.rp-photonics.com/software_news_2018_09_12.html"
    },
    "headline": "Propagating Optical Fields in Fibers Based on Modes or with Numerical Beam Propagation",
    "image": "https://www.rp-photonics.com/previews/software_news_2018_09_12.png",
    "datePublished": "2018-09-12",
    "description": "Mode-based techniques and numerical beam propagation are very different technical methods for propagating optical fields. This article explains them and discusses their limitations in various cases.",
    "author": {
      "@type": "Person",
      "name": "Dr. Rüdiger Paschotta",
      "url": "https://www.rp-photonics.com/paschotta.html",
      "image": "https://www.rp-photonics.com/img/paschotta5.jpg"
    },
    "publisher": {
      "@type": "Organization",
      "name": "RP Photonics",
      "url": "https://www.rp-photonics.com/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.rp-photonics.com/img/rp_photonics.png"
      }
    }
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "name": "RP Photonics Software News",
      "item": "https://www.rp-photonics.com/software.html"
    },{
      "@type": "ListItem",
      "position": 2,
      "name": "2018-09-12",
      "item": "https://www.rp-photonics.com/software_news_2018_09_12.html"
    }]}
}
</script>
</body>
</html>
